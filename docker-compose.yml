version: '3.3'
 
services:
#   load-balancer:
#         build: 
#             context: ./load-balancer
#             dockerfile: Dockerfile
#         image: load-balancer
#         ports: 
#             - 8000:80
#         # depends_on:
#         # - front
#         restart: always
#   front:
#         build:
#             context: ./front
#             dockerfile: Dockerfile
#         image: front
#         depends_on:
#             - back
#         volumes:
#             - "./redis-vol:/data:rw"
  # redis:
  #       image: redis:latest
  #       command: bash -c "redis-server --appendonly yes"
  #       volumes:
  #           - "./redis-vol:/data:rw"
  neo4j:
    image: neo4j:3.5
    restart: unless-stopped
    ports:
      - 7474:7474
      - 7687:7687
    volumes:
      - data:/data
    environment: 
   #   Raise memory limits
      - NEO4J_AUTH=neo4j/adminadmin
      - NEO4J_dbms_memory_pagecache_size=1G
      - NEO4J_dbms.memory.heap.initial_size=1G
      - NEO4J_dbms_memory_heap_max__size=1G
      - NEO4J_dbms.allow_upgrade=true
  back:
    image: aspdocker
    build:
      context: ./back
      dockerfile: Dockerfile
    ports:
       - 8008:80
    depends_on:
        - neo4j
    volumes:
        - "data:/data:rw"
        # - "./redis-vol:/data:rw"
volumes:
    # plugins:
    data:
    # conf:
    # import:
    # logs: